/*
 * convert a javascript date object to persian date
 */

var convert_date = require('date');

function date_to_persian(d, cb) {

   // if cb was not exists set a blank function to it
   cb = cb || function() {};

   // convart d to javascript date, it is important when
   // d is string.
   var date = new Date(d);

   var min = date.getMinutes(),
      hour = date.getHours(),
      second = date.getSeconds();

   // add zero to little numbers
   if (min < 10) min = '0' + String(min);

   if (hour < 10) hour = '0' + String(hour);

   if (second < 10) second = '0' + String(second);

   convert_date.to_shamsi({
      year: date.getFullYear(),
      month: date.getMonth() + 1,
      day: date.getDate()
   }, function(jalali) {
      cb({
         date: jalali.year + "/" + jalali.month + "/" + jalali.day,
         time: hour + ":" + min + ":" + second,
         second_less_time: hour + ":" + min
      })
   });
}

// export it
module.exports = date_to_persian;
