var jalali = require('jalaali-js');

module.exports = (function() {
   var _return = {};

   _return.to_miladi = function(date_obj, cb) {

      cb = cb || function() {};

      // todo : auth of object was incorrect and should change
      if (!date_obj.year || !date_obj.month /*|| (date_obj && date_obj.day )*/ ) {
         console.error(' Alert : using to_miladi function with LOW args'.red);
         cb('low args');
      } else {
         var temp = jalali.toGregorian(
            Number(date_obj.year),
            Number(date_obj.month),
            Number(date_obj.day)
         );

         // month is 0 base because i use month-1
         var d = new Date(temp.gy, temp.gm - 1, temp.gd);
         cb(String(d));
      }
   };

   _return.to_shamsi = function(date_obj, cb) {

      cb = cb || function() {};

      if (!date_obj.year || !date_obj.month /* || !date_obj.day*/ ) {
         console.error(' Alert : using to_shamsi function with LOW args'.red);
         cb("low args");
      } else {
         var temp = jalali.toJalaali(
            Number(date_obj.year),
            Number(date_obj.month),
            Number(date_obj.day)
         );

         cb({
            year: temp.jy,
            month: temp.jm,
            day: temp.jd
         });
      }
   };

   return _return;
})();
